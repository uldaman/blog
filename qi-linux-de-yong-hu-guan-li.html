<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>(七)、Linux 的用户管理</title>

    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/style.css" />
    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/pygments.css" />
    <link rel="shortcut icon" type="image/x-icon" href="http://blog.smallcpp.com/theme/images/favicon.ico" />
    <script src="http://blog.smallcpp.com/theme/js/modernizr.js"></script>
</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="http://blog.smallcpp.com">Small Cpp | 勿在浮沙筑高台, 练从难处练, 用从易处用.</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">

    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
<article>
    <header>
        <h3 class="article-title"><a href="http://blog.smallcpp.com/qi-linux-de-yong-hu-guan-li.html" rel="bookmark"
        title="Permalink to (七)、Linux 的用户管理">(七)、Linux 的用户管理</a></h3>
    </header>

<h6 class="subheader" title="2015-03-30T13:57:00+08:00">Mon 30 March 2015
</h6>


    <h1 id="_1"><a name="user-content-_1" href="#_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>用户和用户组</h1>
<p>**
<strong>Linux 是个多人多任务的系统, 常常会有多人同时使用系统来进行工作的情况, 简单的说, **用户**指的就是使用操作系统的人;
而**用户组</strong>, 就是指具有相同系统权限的一组用户.</p>
<p>来看一个例子(借用鸟哥的私房菜).
假设有一家人, 家里只有三兄弟, 分别是大毛、二毛与三毛. 对于这三人而言, 客厅、厨房、WC等是共同拥有的, 大家都有权限使用.
由于三人各自拥有自己的房间, 三毛觉得让大毛、二毛进入自己的房间无可厚非, 但是自己写给小丽的情书可不能被他们看见, 于是三毛把情书锁在抽屉里.
所以, 大毛、二毛虽然可以进入三毛的房间, 但总不能撬三毛的抽屉吧?!</p>
<p>以上面的例子来说, 这个大家庭就是一个用户组, 三兄弟就是属于这个用户组的用户, 大家都有权限使用这个家里的客厅、厨房、WC等是共同拥有的空间;
而他们的卧室就是用户的个人空间, 用户可以自由设定个人空间的权限, 例如, 二毛可能不希望别人来自己的房间, 而三毛则允许别人进入自己的房间, 但不能翻抽屉.</p>
<p>接着看例子, 假如这三兄弟都是小 P 孩, 而这个家里呢, 还有更高级的存在, 也就是他们的父母啦, 他们的父母拥有家庭里的最高权限, 因此他们可以控制三兄弟的个人空间;
这个父母对应的就是 Linux 里的 root 用户, 即超级管理员用户.</p>
<p>前面说过, Linux 下一切内容皆文件, 因此所有的用户和用户组信息也都被保存在一些关键文件中.
**/etc/group
**存储当前系统中所有用户组信息.
<img alt="" src="http://i57.tinypic.com/2usa6pf.jpg" />
每一行都是一个用户组的信息, 信息被分为 4 部分;
Group : x : 123 : abc,def
组名 : 组密码占位符 : 组ID : 组中用户列表(最后一个信息没有不代表组中没有用户, 因为当组中只有一个用户且用户名和组名相同时, 它也是不显示用户列表的).
对于 Linux 来说, root 组的 ID 始终为 0, 并且 1 – 499 是预留给系统的, 一般是留给系统中的软件或服务. 而我们手动创建的用户 ID 是从 500 开始的.</p>
<p><strong>/etc/gshadow</strong>
存储当前系统中用户组的密码信息
<img alt="" src="http://i62.tinypic.com/2upfpn4.jpg" />
Group : x : : abc,def
组名 : 组密码 : 组管理者 : 组中用户列表(如果组密码是 !、* 或 空 都可以认为这个组没有密码).</p>
<p><strong>/etc/passwd</strong>
存储当前系统中所有用户的信息.
<img alt="" src="http://i60.tinypic.com/2zyzfpu.jpg" />
user : x : 123 : 456 : xxxx : /home/martin : /bin/bash
用户名 : 密码占位符 : 用户ID : 所在组ID : 用户注释信息 : 用户主目录 : 使用的 shell 解释器</p>
<p><strong>/etc/shadow</strong>
存储当前系统中所有用户的密码信息.
<img alt="" src="http://i62.tinypic.com/2mzfc6r.jpg" />
user : asdfasdfasdf… : : : : :
用户 : 加密的密码 : 好吧, 一些乱七八糟东西, 暂时请无视它…了解一下就好.</p>
<h1 id="_2"><a name="user-content-_2" href="#_2" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>用户及用户组的管理命令</h1>
<p>[groupadd] [
</td>
<td width="72" >
</td>
<td width="84" >组名] 添加用户组
[groupmod] [-n] [新组名] [旧组名] 更改用户组的名称
[groupmod] [-g] [新ID] [组名] 更改用户组的ID
[groupadd] [-g] [组ID] [
</td>
<td width="72" >
</td>
<td width="84" >组名] 添加一个指定ID的用户组
[groupdel] [
</td>
<td width="72" >
</td>
<td width="84" >组名] 删除用户组(删除用户组时要确保先删除用户组中的用户)</p>
<p>[useradd] [-g] [用户组] [用户名] 为某个用户组添加用户
[useradd] [-d] [路径] [用户名] 在创建用户的时候指定用户个人文件夹(没有指定用户组的时候, 系统将默认为用户创建一个同名的用户组)
[usermod] [-c] [备注] [用户名] 为用户添加注释
[usermod] [-l] [新用户名] [旧用户名] 更改用户名
[usermod] [-d] [路径] [用户名] 重新指定用户个人文件夹
[usermod] [-g] [目标组名] [用户名] 切换用户的所在用户组
[userdel] [用户名] 删除用户(并不会删除个人文件夹)
[userdel] [-r] [用户名] 删除用户(同时会删除个人文件夹)</p>
<p>[touch] [/etc/nologin] 在 etc 下创建一个 nologin 文件将禁止普通用户登录系统</p>
<p>[passwd] [-l] [用户名] 锁定用户
[passwd] [-u] [用户名] 解锁用户
[passwd] [-d] [用户名] 清除用户密码</p>
<h1 id="_3"><a name="user-content-_3" href="#_3" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>主要组和附属组</h1>
<p>Linux 下允许一个用户属于多个用户组, 这时, 只有一个组是用户的主要组, 其它的都是附属组.
[gpasswd] [-a] [用户名] [组名] 为用户添加附属组, 如果要一次性添加多个附属组, 可以用逗号分隔用户组的名称.
当用一个属于多个用户组的用户来创建一个文件的时候, 默认创建的文件属于用户的主要组, 如果想以附属组的权限来创建一个文件, 就要临时切换用户组.
[newgrp] [组名] [组密码] 临时切换用户组(前提是要先切换成登录的用户再使用这条命令).
[gpasswd] [-d] [用户名] [组名] 将一个用户从它的附属组中删除
[useradd] [-g] [主用户组] [-G] [附属用户组列表(逗号隔开)] [用户名] 添加用户的时候同时指定主用户组和附属用户组</p>
<h1 id="_4"><a name="user-content-_4" href="#_4" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>其他命令</h1>
<p>[gpasswd] [组名] 为用户组添加密码</p>
<p>[su] [username] 切换当前用户, 如果不写 username 为切换成 root 用户, 切换的时候需要输入目标用户密码.
需要注意, Ubuntu 为了系统的安全性, 默认 root 用户为随机密码, 除非手动重设 root 密码, 不过建议不要这么做.
所以一般当我们使用 su 进入超级用户时, 因为我们不知道密码, 所以进不去..
[sudo] [su] 因为上面的原因, 我们可以使用这条命令临时让当前用户有 root 权限, 它只要求输入当前用户的密码, 不过这是有时间限制的, Ubuntu 默认为 15 分钟.
[sudo] [-i] 功能同上, 但是它没有时间限制.</p>
<p>[who am i] 显示当前用户名</p>
<p>[id] [username] 显示指定用户信息, 包括用户ID、用户名、主要组ID及名称、附属组列表</p>
<p>[groups] [username] 显示指定用户所在的所有组</p>
<p>[chfn] [用户名] 设置用户资料(按系统提示依次输入即可)</p>
<p>[finger] [用户名] 显示用户资料
)fS</p>
<p class="subheader">Category: <a href="http://blog.smallcpp.com/category/linux.html">Linux</a>

</p>




<!--      -->

    <!-- 多说评论框 start -->
    <h4>Comments !</h4>
    <div class="ds-thread" data-thread-key="qi-linux-de-yong-hu-guan-li" data-title="(七)、Linux 的用户管理" data-url="http://blog.smallcpp.com/qi-linux-de-yong-hu-guan-li.html"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
        var duoshuoQuery = {short_name:"smallcpp"};
            (function() {
                var ds = document.createElement('script');
                ds.type = 'text/javascript';ds.async = true;
                ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
                ds.charset = 'UTF-8';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
            })();
    </script>
    <!-- 多说公共JS代码 end -->
</article>
    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="http://blog.smallcpp.com/archives.html">Archives</a>
            <li><a href="http://blog.smallcpp.com/tags.html">Tags</a>
        </ul>

        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="http://blog.smallcpp.com/category/ban-ben-kong-zhi.html">版本控制</a></li>
            <li><a href="http://blog.smallcpp.com/category/c11-xin-te-xing.html">C++11 新特性</a></li>
            <li><a href="http://blog.smallcpp.com/category/cocos2d-you-xi-kai-fa.html">Cocos2d 游戏开发</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-hua-she-ji-mo-shi.html">大话设计模式</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-shu-ju.html">大数据</a></li>
            <li><a href="http://blog.smallcpp.com/category/du-shu-bi-ji.html">读书笔记</a></li>
            <li><a href="http://blog.smallcpp.com/category/golang.html">Golang</a></li>
            <li><a href="http://blog.smallcpp.com/category/hadoop.html">hadoop</a></li>
            <li><a href="http://blog.smallcpp.com/category/hei-ke-ji.html">黑科技</a></li>
            <li><a href="http://blog.smallcpp.com/category/ling-ji-chu-qt-ru-men.html">零基础 QT 入门</a></li>
            <li><a href="http://blog.smallcpp.com/category/linux.html">Linux</a></li>
            <li><a href="http://blog.smallcpp.com/category/lua-you-xi-kai-fa.html">Lua 游戏开发</a></li>
            <li><a href="http://blog.smallcpp.com/category/pyqt-kai-fa.html">PyQt 开发</a></li>
            <li><a href="http://blog.smallcpp.com/category/python-cong-ru-men-dao-fang-qi.html">Python 从入门到放弃</a></li>
            <li><a href="http://blog.smallcpp.com/category/shen-ru-qian-chu-mongodb.html">深入浅出 Mongodb</a></li>
            <li><a href="http://blog.smallcpp.com/category/shen-ru-qian-chu-redis.html">深入浅出 Redis</a></li>
            <li><a href="http://blog.smallcpp.com/category/za-xiang.html">杂项</a></li>
            <li><a href="http://blog.smallcpp.com/category/zai-xue-java.html">再学 JAVA</a></li>
        </ul>

        <h5 class="sidebar-title">Links</h5>
        <ul class="side-nav">
            <li><a href="http://blog.csdn.net/u010850265">CSDN</a></li>
        </ul>

        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="http://blog.csdn.net/u010850265">CSDN</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
              <!--                  <p>Small Cpp | 勿在浮沙筑高台, 练从难处练, 用从易处用. by martin</p> -->
            </div>
            </div>
    </div>
</footer>
</body>
</html>