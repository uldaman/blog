<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>026、线程基础(Thinking in Java)</title>

    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/style.css" />
    <link rel="stylesheet" href="http://blog.smallcpp.com/theme/css/pygments.css" />
    <link rel="shortcut icon" type="image/x-icon" href="http://blog.smallcpp.com/theme/images/favicon.ico" />
    <script src="http://blog.smallcpp.com/theme/js/modernizr.js"></script>
</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="http://blog.smallcpp.com">Small Cpp | 勿在浮沙筑高台, 练从难处练, 用从易处用.</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">

    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
<article>
    <header>
        <h3 class="article-title"><a href="http://blog.smallcpp.com/026-xian-cheng-ji-chu-thinking-in-java.html" rel="bookmark"
        title="Permalink to 026、线程基础(Thinking in Java)">026、线程基础(Thinking in Java)</a></h3>
    </header>

<h6 class="subheader" title="2016-03-17T10:55:00+08:00">Thu 17 March 2016
</h6>


    <div class="toc">
<ul>
<li><a href="#1">1. 定义任务</a></li>
<li><a href="#2">2. 附加线程</a></li>
<li><a href="#3-executor">3. Executor</a></li>
<li><a href="#4">4. 休眠</a></li>
<li><a href="#5">5. 优先级</a></li>
<li><a href="#6">6. 后台线程(也称守护线程)</a></li>
<li><a href="#7">7. 另外的创建线程方法</a><ul>
<li><a href="#71-thread">7.1 直接继承 Thread</a></li>
<li><a href="#72-runnable">7.2 自执行 Runnable</a></li>
</ul>
</li>
<li><a href="#8-join">8. 加入线程(join)</a></li>
</ul>
</div>
<h2 id="1"><a name="user-content-1" href="#1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>1. 定义任务</h2>
<p>线程是用来&rdquo;驱动&rdquo;任务的, 通过实现 Runnable 接口的 run() 方法可以来定义一个任务.</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #999988; font-style: italic">// 显示 LiftOff(发射) 前的倒计时</span>
<span style="color: #A71D5D">class</span> <span style="color: #445588">LiftOff</span> <span style="color: #A71D5D">implements</span> <span style="color: #333333">Runnable</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">10</span><span style="color: #A71D7E">;</span> <span style="color: #999988; font-style: italic">// default 倒数次数</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">taskCount</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D">final</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">id</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">taskCount</span><span style="color: #A71D7E">++;</span> <span style="color: #999988; font-style: italic">// 记录线程 id</span>

    <span style="color: #A71D5D">public</span> <span style="color: #795DA3">LiftOff</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #795DA3">LiftOff</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">this</span><span style="color: #A71D7E">.</span><span style="color: #008080">countDown</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #333333">String</span> <span style="color: #795DA3">status</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">return</span> <span style="color: #183691">&quot;#&quot;</span> <span style="color: #A71D7E">+</span> <span style="color: #333333">id</span> <span style="color: #A71D7E">+</span> <span style="color: #183691">&quot;(&quot;</span> <span style="color: #A71D7E">+</span> <span style="color: #A71D7E">(</span><span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;</span> <span style="color: #0086b3">0</span> <span style="color: #A71D7E">?</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">:</span> <span style="color: #183691">&quot;Liftoff!&quot;</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">+</span> <span style="color: #183691">&quot;). &quot;</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">run</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(;</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span>  <span style="color: #333333">countDown</span><span style="color: #A71D7E">--)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">print</span><span style="color: #A71D7E">(</span><span style="color: #333333">status</span><span style="color: #A71D7E">());</span>
            <span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">yield</span><span style="color: #A71D7E">();</span>
        <span style="color: #A71D7E">}</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<p>稍微解释下, id 属性用来区分 LiftOff 任务的多个实例(线程), 所以它被定义成 final 的.</p>
<p><strong>Thread.yield()</strong> 静态方法的作用是对 <em>线程调度器</em> 的一种建议, 它是在声明此刻我(当前线程)放弃对 CPU 的占用权, 现在正是你(CPU)切换时间片的大好时机.</p>
<blockquote>
<p>注意, Thread.yield() 虽然让 CPU 立即执行一次切换, 去执行其他线程, 但是这个&rdquo;其他&rdquo;也包含当前线程&hellip;</p>
</blockquote>
<p>当然, LiftOff 虽然实现了 Runnable, 但并不意味着它必须用新线程去驱动, 它仍然可以单独的使用.</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">public</span> <span style="color: #A71D5D">class</span> <span style="color: #445588">MainThread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">main</span><span style="color: #A71D7E">(</span><span style="color: #333333">String</span><span style="color: #A71D7E">[]</span> <span style="color: #333333">args</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">LiftOff</span> <span style="color: #333333">launch</span> <span style="color: #A71D7E">=</span> <span style="color: #A71D5D">new</span> <span style="color: #333333">LiftOff</span><span style="color: #A71D7E">();</span>
        <span style="color: #333333">launch</span><span style="color: #A71D7E">.</span><span style="color: #008080">run</span><span style="color: #A71D7E">();</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span>del *.class

javac MainThread.java

java MainThread

#0(10). #0(9). #0(8). #0(7). #0(6). #0(5). #0(4). #0(3). #0(2). #0(1). #0(Liftoff!).
</pre></div>


<h2 id="2"><a name="user-content-2" href="#2" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>2. 附加线程</h2>
<p>实现 Runnable 接口后, 要实现线程驱动, 还必须显示地创建一个新线程, 并将 Runnable 附着在其上, <strong>Thread</strong> 类就是用来完成这个动作的, 我们只需要将 Runnable 对象传给 Thread 的构造函数即可.</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">public</span> <span style="color: #A71D5D">class</span> <span style="color: #445588">MainThread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">main</span><span style="color: #A71D7E">(</span><span style="color: #333333">String</span><span style="color: #A71D7E">[]</span> <span style="color: #333333">args</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">Thread</span> <span style="color: #333333">t</span> <span style="color: #A71D7E">=</span> <span style="color: #A71D5D">new</span> <span style="color: #333333">Thread</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">new</span> <span style="color: #333333">LiftOff</span><span style="color: #A71D7E">());</span>
        <span style="color: #333333">t</span><span style="color: #A71D7E">.</span><span style="color: #008080">start</span><span style="color: #A71D7E">();</span>
        <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">println</span><span style="color: #A71D7E">(</span><span style="color: #183691">&quot;Waiting for Liftoff.&quot;</span><span style="color: #A71D7E">);</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<p>创建 Thread 对象后, 调用该对象的 <strong>start()</strong> 方法为新线程执行必需的初始化操作, 然后新线程开始去&rdquo;跑动&rdquo;(即调用 Runnable 的 run() 方法), 执行结果如下:</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span>javac MainThread.java

java MainThread

Waiting for Liftoff.
#0(10). #0(9). #0(8). #0(7). #0(6). #0(5). #0(4). #0(3). #0(2). #0(1). #0(Liftoff).
</pre></div>


<p>我们可以看到, start() 方法是__立即返回__的, 创建运行新线程并不会阻塞当前线程的继续执行.</p>
<p>当然你可以创建更多的线程:</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">public</span> <span style="color: #A71D5D">class</span> <span style="color: #445588">MainThread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">main</span><span style="color: #A71D7E">(</span><span style="color: #333333">String</span><span style="color: #A71D7E">[]</span> <span style="color: #333333">args</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">&lt;</span> <span style="color: #0086b3">5</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span><span style="color: #A71D7E">++)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #333333">Thread</span> <span style="color: #333333">t</span> <span style="color: #A71D7E">=</span> <span style="color: #A71D5D">new</span> <span style="color: #333333">Thread</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">new</span> <span style="color: #333333">LiftOff</span><span style="color: #A71D7E">());</span>
            <span style="color: #333333">t</span><span style="color: #A71D7E">.</span><span style="color: #008080">start</span><span style="color: #A71D7E">();</span>
        <span style="color: #A71D7E">}</span>
        <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">println</span><span style="color: #A71D7E">(</span><span style="color: #183691">&quot;Waiting for Liftoff.&quot;</span><span style="color: #A71D7E">);</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<p>执行结果如下:</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span>del *.class

javac MainThread.java

java MainThread

#0(10). #0(9). #0(8). #0(7). #0(6). #0(5). #0(4). #0(3). #0(2).
#0(1). Waiting for Liftoff. #2(10). #1(10). #1(9). #2(9). #0(Liftoff!).
#4(10). #3(10). #4(9). #2(8). #1(8). #2(7). #4(8). #3(9). #4(7). #2(6).
#1(7). #2(5). #4(6). #4(5). #3(8). #4(4). #2(4). #1(6). #2(3). #4(3).
#3(7). #4(2). #2(2). #1(5). #2(1). #4(1). #3(6). #4(Liftoff!). #2(Liftoff!).
#1(4). #3(5). #1(3). #3(4). #1(2). #3(3). #1(1). #3(2). #1(Liftoff!).
#3(1). #3(Liftoff!).
</pre></div>


<p>可见, 多线程是轮流交换着去执行的.</p>
<h2 id="3-executor"><a name="user-content-3-executor" href="#3-executor" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3. Executor</h2>
<p>Executor 是 Java 中启动线程的优选方案.<br>
它 是 Java SE5的 <strong>java.util.concurrent</strong> 包中的_执行器_, 它可以用来管理 Thread 对象, 相当于一个中间件.</p>
<p>再用上面的 LiftOff 例子, 使用 Executor 我们无须再显示的创建 Thread 对象.</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">import</span> <span style="color: #555555">java.util.concurrent.*</span><span style="color: #A71D7E">;</span>

<span style="color: #A71D5D">public</span> <span style="color: #A71D5D">class</span> <span style="color: #445588">MainThread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">main</span><span style="color: #A71D7E">(</span><span style="color: #333333">String</span><span style="color: #A71D7E">[]</span> <span style="color: #333333">args</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">ExecutorService</span> <span style="color: #333333">exec</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">Executors</span><span style="color: #A71D7E">.</span><span style="color: #008080">newCachedThreadPool</span><span style="color: #A71D7E">();</span>

        <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">&lt;</span> <span style="color: #0086b3">5</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span><span style="color: #A71D7E">++)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #333333">exec</span><span style="color: #A71D7E">.</span><span style="color: #008080">execute</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">new</span> <span style="color: #333333">LiftOff</span><span style="color: #A71D7E">());</span>
        <span style="color: #A71D7E">}</span>
        <span style="color: #333333">exec</span><span style="color: #A71D7E">.</span><span style="color: #008080">shutdown</span><span style="color: #A71D7E">();</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<p>执行结果如下:</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span>javac MainThread.java

java MainThread

#0(10). #1(10). #2(10). #3(10). #2(9). #2(8). #2(7). #2(6).
#2(5). #1(9). #4(10). #0(9). #4(9). #1(8). #2(4). #3(9). #2(3).
#1(7). #1(6). #4(8). #4(7). #4(6). #4(5). #0(8). #0(7). #4(4).
#1(5). #1(4). #2(2). #3(8). #3(7). #2(1). #1(3). #1(2). #1(1).
#1(Liftoff!). #4(3). #0(6). #4(2). #2(Liftoff!). #3(6). #4(1).
#0(5). #4(Liftoff!). #3(5). #3(4). #3(3). #3(2). #0(4). #3(1).
#0(3). #3(Liftoff!). #0(2). #0(1). #0(Liftoff!).
</pre></div>


<p>单个的 Executor 就可以被用来创建和管理系统中所有的任务.</p>
<p><strong>ExecutorService</strong> 接口提供了管理终止的方法(具有生命周期的 Executor), 它知道如何构建恰当的上下文来执行 Runnable 对象.<br>
一个 ExecutorService 的生命周期有三种状态: 运行、关闭、终止.<br>
Executor 创建时处于运行状态, 当调用 shutdown() 后，处于关闭状态, <strong>isShutdown()</strong> 方法返回 true,这时, 不应该再向 Executor 中添加任务, 所有已添加的任务执行完毕后, Executor 处于终止状态, <strong>isTerminated()</strong> 返回 true.<br>
如果 Executor 处于关闭状态, 往 Executor 提交任务会抛出 unchecked exception RejectedExecutionException.</p>
<p><strong>shutdown()</strong> 方法防止新任务被提交给 Executor, 但允许执行以前提交的任务.<br>
另外还有个 <strong>shutdownNow()</strong> 方法, 它阻止等待任务的启动并试图停止当前正在执行的任务.</p>
<p><strong>CachedThreadPool</strong> 类型的 Executor 将为每个任务根据需要创建新线程的线程池.<br>
除了 CachedThreadPool 外, Executor 还有其他的一些类型:</p>
<ul>
<li>public static ExecutorService <strong>newFixedThreadPool</strong>(int nThreads)<ul>
<li>创建固定数目线程的线程池</li>
</ul>
</li>
<li>public static ExecutorService <strong>newSingleThreadExecutor</strong>()<ul>
<li>创建一个单线程化的 Executor</li>
<li>如果向 Single Executor 中添加了多任务, 这些任务会&rdquo;排队执行&rdquo;</li>
</ul>
</li>
<li>public static ScheduledExecutorService <strong>newScheduledThreadPool</strong>(int corePoolSize)<ul>
<li>创建一个支持定时及周期性的任务执行的线程池, 多数情况下可用来替代 Timer 类</li>
</ul>
</li>
</ul>
<h2 id="4"><a name="user-content-4" href="#4" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>4. 休眠</h2>
<p>让线程休眠的方法就是调用  <strong>Thread.sleep()</strong>.</p>
<p>继续刚才的 LiftOff 的例子, 我们只需要更它的 run() 方法.</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">public</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">run</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">try</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(;</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span>  <span style="color: #333333">countDown</span><span style="color: #A71D7E">--)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">print</span><span style="color: #A71D7E">(</span><span style="color: #333333">status</span><span style="color: #A71D7E">());</span>
            <span style="color: #999988; font-style: italic">// Thread.sleep(100);</span>
            <span style="color: #999988; font-style: italic">// java SE5 style:</span>
            <span style="color: #333333">TimeUnit</span><span style="color: #A71D7E">.</span><span style="color: #008080">MILLISECONDS</span><span style="color: #A71D7E">.</span><span style="color: #008080">sleep</span><span style="color: #A71D7E">(</span><span style="color: #0086b3">100</span><span style="color: #A71D7E">);</span>
        <span style="color: #A71D7E">}</span>
    <span style="color: #A71D7E">}</span> <span style="color: #A71D5D">catch</span> <span style="color: #A71D7E">(</span><span style="color: #333333">InterruptedException</span> <span style="color: #333333">e</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">println</span><span style="color: #A71D7E">(</span><span style="color: #183691">&quot;Interrupted Exception&quot;</span><span style="color: #A71D7E">);</span>
    <span style="color: #A71D7E">}</span>

<span style="color: #A71D7E">}</span>
</pre></div>


<p>sleep() 与 yield() 的区别就在于, sleep() 除了拥有 yield() 的功能外, 还可以让 cpu 在指定时间内不再切换回自身.</p>
<p>sleep() 的调用会抛出 <strong>InterruptedException</strong> 异常, 因为异常不能跨线程传播, 所以我们必须在线程本地处理掉.</p>
<p>Java SE5 引入了更加显示的 sleep(), 作为 <strong>TimeUnit</strong> 类的一部分, 这个方法允许指定 sleep() 的时间单位, 如上面的就是 <strong>MILLISECONDS</strong>(毫秒).</p>
<h2 id="5"><a name="user-content-5" href="#5" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>5. 优先级</h2>
<p>简单的说, 线程调试器会让优先级高的线程先执行, 但并不是意味着优先级低的线程就得不到执行了, 它只是执行的频率低一些而已.</p>
<p>可以使用 <strong>Thread.getPriority()</strong> 来获取现有线程的优先级, 使用 <strong>Thread.setPriority()</strong> 来修改它.</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">import</span> <span style="color: #555555">java.util.concurrent.*</span><span style="color: #A71D7E">;</span>

<span style="color: #A71D5D">class</span> <span style="color: #445588">SimplePriorities</span> <span style="color: #A71D5D">implements</span> <span style="color: #333333">Runnable</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">5</span><span style="color: #A71D7E">;</span> <span style="color: #999988; font-style: italic">// 倒计时</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D; font-weight: bold">double</span> <span style="color: #333333">d</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">priority</span><span style="color: #A71D7E">;</span> <span style="color: #999988; font-style: italic">// 优先级</span>

    <span style="color: #A71D5D">public</span> <span style="color: #795DA3">SimplePriorities</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">priority</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">this</span><span style="color: #A71D7E">.</span><span style="color: #008080">priority</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">priority</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #333333">String</span> <span style="color: #795DA3">toString</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">return</span> <span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">currentThread</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">+</span> <span style="color: #183691">&quot;: &quot;</span> <span style="color: #A71D7E">+</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">run</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">currentThread</span><span style="color: #A71D7E">().</span><span style="color: #008080">setPriority</span><span style="color: #A71D7E">(</span><span style="color: #333333">priority</span><span style="color: #A71D7E">);</span>

        <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(;</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">--)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #999988; font-style: italic">// 进行一个稍大开销的运算, 让效果明显点</span>
            <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">1</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">&lt;</span> <span style="color: #0086b3">100000</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span><span style="color: #A71D7E">++)</span> <span style="color: #A71D7E">{</span>
                <span style="color: #333333">d</span> <span style="color: #A71D7E">+=</span> <span style="color: #A71D7E">(</span><span style="color: #333333">Math</span><span style="color: #A71D7E">.</span><span style="color: #008080">PI</span> <span style="color: #A71D7E">+</span> <span style="color: #333333">Math</span><span style="color: #A71D7E">.</span><span style="color: #008080">E</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">/</span> <span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">double</span><span style="color: #A71D7E">)</span><span style="color: #333333">i</span><span style="color: #A71D7E">;</span>
                <span style="color: #A71D5D">if</span> <span style="color: #A71D7E">(</span><span style="color: #333333">i</span> <span style="color: #A71D7E">%</span> <span style="color: #0086b3">1000</span> <span style="color: #A71D7E">==</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
                    <span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">yield</span><span style="color: #A71D7E">();</span>
                <span style="color: #A71D7E">}</span>
            <span style="color: #A71D7E">}</span>

            <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">println</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">this</span><span style="color: #A71D7E">);</span>
        <span style="color: #A71D7E">}</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>

<span style="color: #A71D5D">public</span> <span style="color: #A71D5D">class</span> <span style="color: #445588">MainThread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">main</span><span style="color: #A71D7E">(</span><span style="color: #333333">String</span><span style="color: #A71D7E">[]</span> <span style="color: #333333">args</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">ExecutorService</span> <span style="color: #333333">exec</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">Executors</span><span style="color: #A71D7E">.</span><span style="color: #008080">newCachedThreadPool</span><span style="color: #A71D7E">();</span>
        <span style="color: #A71D5D">for</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span> <span style="color: #A71D7E">&lt;</span> <span style="color: #0086b3">5</span><span style="color: #A71D7E">;</span> <span style="color: #333333">i</span><span style="color: #A71D7E">++)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #333333">exec</span><span style="color: #A71D7E">.</span><span style="color: #008080">execute</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">new</span> <span style="color: #333333">SimplePriorities</span><span style="color: #A71D7E">(</span><span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">MIN_PRIORITY</span><span style="color: #A71D7E">));</span>
        <span style="color: #A71D7E">}</span>
        <span style="color: #333333">exec</span><span style="color: #A71D7E">.</span><span style="color: #008080">execute</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">new</span> <span style="color: #333333">SimplePriorities</span><span style="color: #A71D7E">(</span><span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">MAX_PRIORITY</span><span style="color: #A71D7E">));</span>
        <span style="color: #333333">exec</span><span style="color: #A71D7E">.</span><span style="color: #008080">shutdown</span><span style="color: #A71D7E">();</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<p>执行结果如下:</p>
<p><div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span>Thread[pool-1-thread-2,1,main]: 5
Thread[pool-1-thread-3,1,main]: 5
Thread[pool-1-thread-1,1,main]: 5
Thread[pool-1-thread-4,1,main]: 5
Thread[pool-1-thread-6,10,main]: 5
Thread[pool-1-thread-5,1,main]: 5
Thread[pool-1-thread-3,1,main]: 4
Thread[pool-1-thread-2,1,main]: 4
...
</pre></div>

在 SimplePriorities 中完成了 <strong>toString()</strong> 的覆盖用来打印*线程的名称*、<em>优先级*及线程所属*线程组</em>, <strong>Thread.currentThread()</strong> 方法可以用来获取当前任务所在线程的 Thread 对象引用.</p>
<p>在 main 中, 我们创建 5 个低优化级的线程和 1 个高优先级的线程, 因为优化级与操作系统有依赖, 所以唯一的可移植设置是使用:</p>
<ul>
<li>MIN_PRIORITY</li>
<li>NORM_PRIORITY</li>
<li>MAX_PRIORITY</li>
</ul>
<p>现在说说为什么要在 run() 中设计那么一个稍大开销的运算?<br>
先看看注释掉那段运算后执行的结果:</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span>Thread[pool-1-thread-2,1,main]: 5
Thread[pool-1-thread-2,1,main]: 4
Thread[pool-1-thread-2,1,main]: 3
Thread[pool-1-thread-2,1,main]: 2
Thread[pool-1-thread-2,1,main]: 1
Thread[pool-1-thread-6,10,main]: 5
Thread[pool-1-thread-6,10,main]: 4
...
</pre></div>


<p>可以看到, 这些输出几乎是连续的(前几个都是 pool-1-thread-2).<br>如果没有加入这些运算的话, 因为 CPU 执行是非常快速的, 没有开销大的运算, 线程还没发生切换就被执行完了, 这样也就看不到设置的优先级效果.</p>
<h2 id="6"><a name="user-content-6" href="#6" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>6. 后台线程(也称守护线程)</h2>
<p>所谓 <strong>Daemon</strong> 线程, 是指在程序运行时在后台提供一种通用服务的线程, 当所有的非后台线程线束时, 程序也就终止了, 同时会杀死进程中的所有后台线程.</p>
<p><strong>setDaemon()</strong> 方法可以将一个线程设置为后台线程, 但是注意, 它必须要在__线程启动前设置__.</p>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #333333">Thread</span> <span style="color: #333333">daemon</span> <span style="color: #A71D7E">=</span> <span style="color: #A71D5D">new</span> <span style="color: #333333">Thread</span><span style="color: #A71D7E">();</span>
<span style="color: #333333">daemon</span><span style="color: #A71D7E">.</span><span style="color: #008080">setDaemon</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">true</span><span style="color: #A71D7E">);</span>
<span style="color: #333333">daemon</span><span style="color: #A71D7E">.</span><span style="color: #008080">start</span><span style="color: #A71D7E">();</span>
</pre></div>


<p>这里我们没有使用 Executor, 而是通过 Thread 显示的创建线程, 以便可以设置线程的后台标志.</p>
<p>通过编写定制的 ThreadFactory 也可以定制由 Executor 创建的线程的属性(后台、优先级及名称), 这里就不演示了.</p>
<p><strong>isDaemon()</strong> 方法返回一个线程是否是后台线程.</p>
<blockquote>
<p>由后台线损创建的任何其它线程也将自动地被设置为后台线程.</p>
</blockquote>
<p>还有一个情况就是 <strong>finally</strong> 语句, 如果所有的非后台线程都结束, 那么后台线程会在不执行 finally 语句的情况下被终止.</p>
<p>所以这几乎是一种不好的思想, 因为__非后台的 Executor__ 通常是一种更好的守护方式, 因为 Executor 控制的所有线程可以同时被关闭, 在后面将会提及.</p>
<h2 id="7"><a name="user-content-7" href="#7" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>7. 另外的创建线程方法</h2>
<p>虽然使用 Executor 是优选的方案, 但还是要了解一下另外两种创建新线程的方法.</p>
<h3 id="71-thread"><a name="user-content-71-thread" href="#71-thread" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>7.1 直接继承 Thread</h3>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">class</span> <span style="color: #445588">LiftOff</span> <span style="color: #A71D5D">extends</span> <span style="color: #333333">Thread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">10</span><span style="color: #A71D7E">;</span> <span style="color: #999988; font-style: italic">// default 倒数次数</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">taskCount</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D">final</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">id</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">taskCount</span><span style="color: #A71D7E">++;</span> <span style="color: #999988; font-style: italic">// 记录线程 id</span>

    <span style="color: #A71D5D">public</span> <span style="color: #795DA3">LiftOff</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #795DA3">LiftOff</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">this</span><span style="color: #A71D7E">.</span><span style="color: #008080">countDown</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #333333">String</span> <span style="color: #795DA3">status</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">return</span> <span style="color: #183691">&quot;#&quot;</span> <span style="color: #A71D7E">+</span> <span style="color: #333333">id</span> <span style="color: #A71D7E">+</span> <span style="color: #183691">&quot;(&quot;</span> <span style="color: #A71D7E">+</span> <span style="color: #A71D7E">(</span><span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;</span> <span style="color: #0086b3">0</span> <span style="color: #A71D7E">?</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">:</span> <span style="color: #183691">&quot;Liftoff!&quot;</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">+</span> <span style="color: #183691">&quot;). &quot;</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">run</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(;</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span>  <span style="color: #333333">countDown</span><span style="color: #A71D7E">--)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">print</span><span style="color: #A71D7E">(</span><span style="color: #333333">status</span><span style="color: #A71D7E">());</span>
            <span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">yield</span><span style="color: #A71D7E">();</span>
        <span style="color: #A71D7E">}</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>

<span style="color: #A71D5D">public</span> <span style="color: #A71D5D">class</span> <span style="color: #445588">MainThread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">main</span><span style="color: #A71D7E">(</span><span style="color: #333333">String</span><span style="color: #A71D7E">[]</span> <span style="color: #333333">args</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">LiftOff</span> <span style="color: #333333">launch</span> <span style="color: #A71D7E">=</span> <span style="color: #A71D5D">new</span> <span style="color: #333333">LiftOff</span><span style="color: #A71D7E">();</span>
        <span style="color: #333333">launch</span><span style="color: #A71D7E">.</span><span style="color: #008080">start</span><span style="color: #A71D7E">();</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<h3 id="72-runnable"><a name="user-content-72-runnable" href="#72-runnable" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>7.2 自执行 Runnable</h3>
<div class="codehilite" style="background: #F7F7F7"><pre style="line-height: 125%"><span></span><span style="color: #A71D5D">class</span> <span style="color: #445588">LiftOff</span> <span style="color: #A71D5D">implements</span> <span style="color: #333333">Runnable</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">10</span><span style="color: #A71D7E">;</span> <span style="color: #999988; font-style: italic">// default 倒数次数</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">taskCount</span> <span style="color: #A71D7E">=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D5D">private</span> <span style="color: #A71D5D">final</span> <span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">id</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">taskCount</span><span style="color: #A71D7E">++;</span> <span style="color: #999988; font-style: italic">// 记录线程 id</span>
    <span style="color: #A71D5D">private</span> <span style="color: #333333">Thread</span> <span style="color: #333333">t</span> <span style="color: #A71D7E">=</span> <span style="color: #A71D5D">new</span> <span style="color: #333333">Thread</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D">this</span><span style="color: #A71D7E">);</span> <span style="color: #999988; font-style: italic">// 创建一个线程成员属性</span>

    <span style="color: #A71D5D">public</span> <span style="color: #795DA3">LiftOff</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">t</span><span style="color: #A71D7E">.</span><span style="color: #008080">start</span><span style="color: #A71D7E">();</span> <span style="color: #999988; font-style: italic">// 执行线程</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #795DA3">LiftOff</span><span style="color: #A71D7E">(</span><span style="color: #A71D5D; font-weight: bold">int</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">this</span><span style="color: #A71D7E">.</span><span style="color: #008080">countDown</span> <span style="color: #A71D7E">=</span> <span style="color: #333333">countDown</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #333333">String</span> <span style="color: #795DA3">status</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">return</span> <span style="color: #183691">&quot;#&quot;</span> <span style="color: #A71D7E">+</span> <span style="color: #333333">id</span> <span style="color: #A71D7E">+</span> <span style="color: #183691">&quot;(&quot;</span> <span style="color: #A71D7E">+</span> <span style="color: #A71D7E">(</span><span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;</span> <span style="color: #0086b3">0</span> <span style="color: #A71D7E">?</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">:</span> <span style="color: #183691">&quot;Liftoff!&quot;</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">+</span> <span style="color: #183691">&quot;). &quot;</span><span style="color: #A71D7E">;</span>
    <span style="color: #A71D7E">}</span>

    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">run</span><span style="color: #A71D7E">()</span> <span style="color: #A71D7E">{</span>
        <span style="color: #A71D5D">for</span> <span style="color: #A71D7E">(;</span> <span style="color: #333333">countDown</span> <span style="color: #A71D7E">&gt;=</span> <span style="color: #0086b3">0</span><span style="color: #A71D7E">;</span>  <span style="color: #333333">countDown</span><span style="color: #A71D7E">--)</span> <span style="color: #A71D7E">{</span>
            <span style="color: #333333">System</span><span style="color: #A71D7E">.</span><span style="color: #008080">out</span><span style="color: #A71D7E">.</span><span style="color: #008080">print</span><span style="color: #A71D7E">(</span><span style="color: #333333">status</span><span style="color: #A71D7E">());</span>
            <span style="color: #333333">Thread</span><span style="color: #A71D7E">.</span><span style="color: #008080">yield</span><span style="color: #A71D7E">();</span>
        <span style="color: #A71D7E">}</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>

<span style="color: #A71D5D">public</span> <span style="color: #A71D5D">class</span> <span style="color: #445588">MainThread</span> <span style="color: #A71D7E">{</span>
    <span style="color: #A71D5D">public</span> <span style="color: #A71D5D">static</span> <span style="color: #A71D5D; font-weight: bold">void</span> <span style="color: #795DA3">main</span><span style="color: #A71D7E">(</span><span style="color: #333333">String</span><span style="color: #A71D7E">[]</span> <span style="color: #333333">args</span><span style="color: #A71D7E">)</span> <span style="color: #A71D7E">{</span>
        <span style="color: #333333">LiftOff</span> <span style="color: #333333">launch</span> <span style="color: #A71D7E">=</span> <span style="color: #A71D5D">new</span> <span style="color: #333333">LiftOff</span><span style="color: #A71D7E">();</span>
        <span style="color: #333333">launch</span><span style="color: #A71D7E">.</span><span style="color: #008080">start</span><span style="color: #A71D7E">();</span>
    <span style="color: #A71D7E">}</span>
<span style="color: #A71D7E">}</span>
</pre></div>


<h2 id="8-join"><a name="user-content-8-join" href="#8-join" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>8. 加入线程(join)</h2>
<p>一个线程可以在其他线程之上调用 <strong>join()</strong> 方法, 这个方法是阻塞的, 它的含义在于等到被 join 的线程执行结束之后再执行新线程.</p>
<p>join() 方法还可以加一个__超时参数__, 其意义在于如果等待超时后, join() 方法也能返回.</p>
<p>join() 方法还可以被__中断__, 在被 join 的线程上调用  <strong>interrupt()</strong> 方法, 不过这个方法会抛出 <strong>InterruptedException</strong> 异常.</p>
<p class="subheader">Category: <a href="http://blog.smallcpp.com/category/da-shu-ju-java-ji-chu.html">大数据 Java 基础</a>

</p>




<!--      -->

    <!-- 多说评论框 start -->
    <h4>Comments !</h4>
    <div class="ds-thread" data-thread-key="026-xian-cheng-ji-chu-thinking-in-java" data-title="026、线程基础(Thinking in Java)" data-url="http://blog.smallcpp.com/026-xian-cheng-ji-chu-thinking-in-java.html"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
        var duoshuoQuery = {short_name:"smallcpp"};
            (function() {
                var ds = document.createElement('script');
                ds.type = 'text/javascript';ds.async = true;
                ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
                ds.charset = 'UTF-8';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
            })();
    </script>
    <!-- 多说公共JS代码 end -->
</article>
    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="http://blog.smallcpp.com/archives.html">Archives</a>
            <li><a href="http://blog.smallcpp.com/tags.html">Tags</a>
        </ul>

        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="http://blog.smallcpp.com/category/c11.html">C++11</a></li>
            <li><a href="http://blog.smallcpp.com/category/cocos2d.html">Cocos2d</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-hua-she-ji-mo-shi.html">大话设计模式</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-shu-ju.html">大数据</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-shu-ju-java-ji-chu.html">大数据 Java 基础</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-shu-ju-linux-ji-chu.html">大数据 Linux 基础</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-shu-ju-mongodb-ji-chu.html">大数据 Mongodb 基础</a></li>
            <li><a href="http://blog.smallcpp.com/category/da-shu-ju-redis-ji-chu.html">大数据 Redis 基础</a></li>
            <li><a href="http://blog.smallcpp.com/category/du-shu-bi-ji.html">读书笔记</a></li>
            <li><a href="http://blog.smallcpp.com/category/golang.html">Golang</a></li>
            <li><a href="http://blog.smallcpp.com/category/hei-ke-ji.html">黑科技</a></li>
            <li><a href="http://blog.smallcpp.com/category/java.html">JAVA</a></li>
            <li><a href="http://blog.smallcpp.com/category/lua.html">Lua</a></li>
            <li><a href="http://blog.smallcpp.com/category/pyqt.html">PyQt</a></li>
            <li><a href="http://blog.smallcpp.com/category/python.html">Python</a></li>
            <li><a href="http://blog.smallcpp.com/category/qt.html">QT</a></li>
            <li><a href="http://blog.smallcpp.com/category/za-xiang.html">杂项</a></li>
        </ul>

        <h5 class="sidebar-title">Links</h5>
        <ul class="side-nav">
            <li><a href="http://blog.csdn.net/u010850265">CSDN</a></li>
        </ul>

        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="http://blog.csdn.net/u010850265">CSDN</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
              <!--                  <p>Small Cpp | 勿在浮沙筑高台, 练从难处练, 用从易处用. by martin</p> -->
            </div>
            </div>
    </div>
</footer>
</body>
</html>